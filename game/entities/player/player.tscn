[gd_scene load_steps=33 format=3 uid="uid://djmlmtr41m2ce"]

[ext_resource type="Script" path="res://entities/player/Player.gd" id="1_n7144"]
[ext_resource type="Script" path="res://addons/godot_state_charts/state_chart.gd" id="2_dhjab"]
[ext_resource type="Texture2D" uid="uid://bt38xi7oyn7xv" path="res://entities/player/assets/defaultState.png" id="2_nfb20"]
[ext_resource type="Script" path="res://addons/godot_state_charts/parallel_state.gd" id="3_7lhhd"]
[ext_resource type="PackedScene" uid="uid://bvq77pvlf1qxo" path="res://entities/components/heat/HeatComponent.tscn" id="3_kjfn2"]
[ext_resource type="PackedScene" uid="uid://d71bkm5ic0tt" path="res://entities/components/ranged/RangedComponent.tscn" id="4_2iwex"]
[ext_resource type="Script" path="res://addons/godot_state_charts/compound_state.gd" id="4_klwk4"]
[ext_resource type="Script" path="res://entities/player/Sprites.gd" id="4_vvtsh"]
[ext_resource type="PackedScene" uid="uid://c5yieglatmln5" path="res://entities/player/chemicalEffectsManager.tscn" id="5_cbv3l"]
[ext_resource type="Script" path="res://addons/godot_state_charts/atomic_state.gd" id="5_dadqm"]
[ext_resource type="Texture2D" uid="uid://d0qc6euyej0r2" path="res://entities/player/assets/iceState.png" id="5_ghnpr"]
[ext_resource type="Script" path="res://addons/godot_state_charts/transition.gd" id="6_aaxtf"]
[ext_resource type="Script" path="res://addons/godot_state_charts/expression_guard.gd" id="7_m5qsp"]
[ext_resource type="Script" path="res://addons/godot_state_charts/state_is_active_guard.gd" id="8_3t36e"]
[ext_resource type="Script" path="res://addons/godot_state_charts/not_guard.gd" id="9_qrtxb"]
[ext_resource type="PackedScene" uid="uid://tdd5ci5su0wo" path="res://entities/components/meleeCombat/MeleeComponent.tscn" id="14_pebxf"]
[ext_resource type="Script" path="res://entities/player/inventory/Inventory.gd" id="15_8nkrm"]
[ext_resource type="PackedScene" uid="uid://bxtfkclrv3vwa" path="res://entities/components/health/HealthComponent.tscn" id="16_vgsyb"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_obf3n"]
size = Vector2(67.9998, 44.5003)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_8ockj"]
size = Vector2(38, 29.5)

[sub_resource type="Resource" id="Resource_r58ym"]
script = ExtResource("7_m5qsp")
expression = "crouching == true and over_slide_threshold"

[sub_resource type="Resource" id="Resource_jk8u2"]
script = ExtResource("7_m5qsp")
expression = "crouching == true"

[sub_resource type="Resource" id="Resource_8wh4l"]
script = ExtResource("7_m5qsp")
expression = "!over_slide_threshold"

[sub_resource type="Resource" id="Resource_wu70w"]
script = ExtResource("7_m5qsp")
expression = "crouching != true"

[sub_resource type="Resource" id="Resource_7ckxi"]
script = ExtResource("8_3t36e")
state = NodePath("../Airborne")

[sub_resource type="Resource" id="Resource_sktov"]
script = ExtResource("9_qrtxb")
guard = SubResource("Resource_7ckxi")

[sub_resource type="Resource" id="Resource_y14vn"]
script = ExtResource("7_m5qsp")
expression = "jumps_left > 0"

[sub_resource type="Resource" id="Resource_cg3bt"]
script = ExtResource("8_3t36e")
state = NodePath("../WallSlide")

[sub_resource type="Resource" id="Resource_6rl8s"]
script = ExtResource("9_qrtxb")
guard = SubResource("Resource_cg3bt")

[sub_resource type="Resource" id="Resource_p8ca0"]
script = ExtResource("8_3t36e")
state = NodePath("../Grounded")

[sub_resource type="Resource" id="Resource_c7udc"]
script = ExtResource("9_qrtxb")
guard = SubResource("Resource_p8ca0")

[sub_resource type="Resource" id="Resource_scptp"]
script = ExtResource("8_3t36e")
state = NodePath("../../../Cooldowns/Dash/Useable")

[node name="Player" type="CharacterBody2D" groups=["player"]]
collision_layer = 2
collision_mask = 5
floor_constant_speed = true
floor_snap_length = 23.0
script = ExtResource("1_n7144")

[node name="HealthComponent" parent="." instance=ExtResource("16_vgsyb")]
unique_name_in_owner = true
element = 0

[node name="HeatComponent" parent="." node_paths=PackedStringArray("health_component", "heat_reduction_delay", "heat_tick") instance=ExtResource("3_kjfn2")]
unique_name_in_owner = true
health_component = NodePath("../HealthComponent")
heat_reduction_delay = NodePath("../Timers/HeatReductionDelay")
heat_tick = NodePath("../Timers/HeatTick")

[node name="RangedComponent" parent="." instance=ExtResource("4_2iwex")]
unique_name_in_owner = true
position = Vector2(0, -24)
use_cooldown = true

[node name="ChemicalEffectsManager" parent="." instance=ExtResource("5_cbv3l")]

[node name="MeleeComponent" parent="." node_paths=PackedStringArray("attack_shape") instance=ExtResource("14_pebxf")]
rotation = -4.46638e-06
collision_mask = 4
attack_shape = NodePath("AttackShape")
attack_color = Color(0.188235, 0.560784, 0.709804, 1)

[node name="AttackShape" type="CollisionShape2D" parent="MeleeComponent"]
position = Vector2(45.5001, -16.9998)
shape = SubResource("RectangleShape2D_obf3n")
debug_color = Color(1, 1, 1, 0.419608)

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
position = Vector2(0, -14.75)
shape = SubResource("RectangleShape2D_8ockj")
debug_color = Color(0.917647, 0.172549, 0.568627, 0.419608)

[node name="Sprites" type="Node2D" parent="."]
script = ExtResource("4_vvtsh")

[node name="Ice" type="Sprite2D" parent="Sprites"]
visible = false
position = Vector2(0, -13.5)
scale = Vector2(0.5, 0.5)
texture = ExtResource("5_ghnpr")

[node name="Default" type="Sprite2D" parent="Sprites"]
modulate = Color(1, 0.980392, 0.976471, 1)
position = Vector2(0, -17)
scale = Vector2(0.5, 0.5)
texture = ExtResource("2_nfb20")
region_enabled = true
region_rect = Rect2(0, 0, 80, 68.376)

[node name="Timers" type="Node2D" parent="."]

[node name="HeatTick" type="Timer" parent="Timers"]
autostart = true

[node name="HeatReductionDelay" type="Timer" parent="Timers"]
wait_time = 2.0
one_shot = true

[node name="HealTick" type="Timer" parent="Timers"]
autostart = true

[node name="Inventory" type="Node2D" parent="."]
script = ExtResource("15_8nkrm")

[node name="StateChart" type="Node" parent="."]
unique_name_in_owner = true
script = ExtResource("2_dhjab")

[node name="Mechanics" type="Node" parent="StateChart"]
script = ExtResource("3_7lhhd")

[node name="Movement" type="Node" parent="StateChart/Mechanics"]
script = ExtResource("4_klwk4")
initial_state = NodePath("Interruptible")

[node name="Interruptible" type="Node" parent="StateChart/Mechanics/Movement"]
script = ExtResource("4_klwk4")
initial_state = NodePath("Airborne")

[node name="Grounded" type="Node" parent="StateChart/Mechanics/Movement/Interruptible"]
script = ExtResource("4_klwk4")
initial_state = NodePath("Standing")

[node name="Standing" type="Node" parent="StateChart/Mechanics/Movement/Interruptible/Grounded"]
script = ExtResource("5_dadqm")

[node name="On Slide" type="Node" parent="StateChart/Mechanics/Movement/Interruptible/Grounded/Standing"]
script = ExtResource("6_aaxtf")
to = NodePath("../../Crouching/Sliding")
event = &"tick"
guard = SubResource("Resource_r58ym")

[node name="On Crouch" type="Node" parent="StateChart/Mechanics/Movement/Interruptible/Grounded/Standing"]
process_priority = 1
script = ExtResource("6_aaxtf")
to = NodePath("../../Crouching")
event = &"tick"
guard = SubResource("Resource_jk8u2")

[node name="Crouching" type="Node" parent="StateChart/Mechanics/Movement/Interruptible/Grounded"]
script = ExtResource("4_klwk4")
initial_state = NodePath("Crouch")

[node name="Crouch" type="Node" parent="StateChart/Mechanics/Movement/Interruptible/Grounded/Crouching"]
script = ExtResource("5_dadqm")

[node name="Sliding" type="Node" parent="StateChart/Mechanics/Movement/Interruptible/Grounded/Crouching"]
script = ExtResource("5_dadqm")

[node name="On Slide End" type="Node" parent="StateChart/Mechanics/Movement/Interruptible/Grounded/Crouching/Sliding"]
script = ExtResource("6_aaxtf")
to = NodePath("../../Crouch")
event = &"tick"
guard = SubResource("Resource_8wh4l")

[node name="On Crouch End" type="Node" parent="StateChart/Mechanics/Movement/Interruptible/Grounded/Crouching"]
script = ExtResource("6_aaxtf")
to = NodePath("../../Standing")
event = &"tick"
guard = SubResource("Resource_wu70w")

[node name="Airborne" type="Node" parent="StateChart/Mechanics/Movement/Interruptible"]
script = ExtResource("4_klwk4")
initial_state = NodePath("Falling")

[node name="Jumping" type="Node" parent="StateChart/Mechanics/Movement/Interruptible/Airborne"]
script = ExtResource("5_dadqm")

[node name="On Falling" type="Node" parent="StateChart/Mechanics/Movement/Interruptible/Airborne/Jumping"]
script = ExtResource("6_aaxtf")
to = NodePath("../../Falling")
event = &"falling"

[node name="FallingCoyote" type="Node" parent="StateChart/Mechanics/Movement/Interruptible/Airborne"]
script = ExtResource("5_dadqm")

[node name="CoyoteDelay" type="Node" parent="StateChart/Mechanics/Movement/Interruptible/Airborne/FallingCoyote"]
script = ExtResource("6_aaxtf")
to = NodePath("../../Falling")
delay_seconds = 0.2

[node name="Falling" type="Node" parent="StateChart/Mechanics/Movement/Interruptible/Airborne"]
script = ExtResource("5_dadqm")

[node name="WallSlide" type="Node" parent="StateChart/Mechanics/Movement/Interruptible"]
script = ExtResource("5_dadqm")

[node name="On FallingCoyote" type="Node" parent="StateChart/Mechanics/Movement/Interruptible"]
script = ExtResource("6_aaxtf")
to = NodePath("../Airborne/FallingCoyote")
event = &"falling"
guard = SubResource("Resource_sktov")

[node name="On Jump" type="Node" parent="StateChart/Mechanics/Movement/Interruptible"]
script = ExtResource("6_aaxtf")
to = NodePath("../Airborne/Jumping")
event = &"jump"
guard = SubResource("Resource_y14vn")

[node name="On WallSlide" type="Node" parent="StateChart/Mechanics/Movement/Interruptible"]
script = ExtResource("6_aaxtf")
to = NodePath("../WallSlide")
event = &"wall_slide"
guard = SubResource("Resource_6rl8s")

[node name="On Grounded" type="Node" parent="StateChart/Mechanics/Movement/Interruptible"]
script = ExtResource("6_aaxtf")
to = NodePath("../Grounded")
event = &"grounded"
guard = SubResource("Resource_c7udc")

[node name="On Dash" type="Node" parent="StateChart/Mechanics/Movement/Interruptible"]
script = ExtResource("6_aaxtf")
to = NodePath("../../Dash")
event = &"dash"
guard = SubResource("Resource_scptp")

[node name="Dash" type="Node" parent="StateChart/Mechanics/Movement"]
script = ExtResource("5_dadqm")

[node name="On End Dash" type="Node" parent="StateChart/Mechanics/Movement/Dash"]
script = ExtResource("6_aaxtf")
to = NodePath("../..")
delay_seconds = 0.3

[node name="Disabled" type="Node" parent="StateChart/Mechanics/Movement"]
script = ExtResource("5_dadqm")

[node name="On Enable" type="Node" parent="StateChart/Mechanics/Movement/Disabled"]
script = ExtResource("6_aaxtf")
to = NodePath("../..")
event = &"enable"

[node name="On Disable" type="Node" parent="StateChart/Mechanics/Movement"]
script = ExtResource("6_aaxtf")
to = NodePath("../Disabled")
event = &"disable"

[node name="Cooldowns" type="Node" parent="StateChart/Mechanics"]
script = ExtResource("3_7lhhd")

[node name="Dash" type="Node" parent="StateChart/Mechanics/Cooldowns"]
script = ExtResource("4_klwk4")
initial_state = NodePath("Useable")

[node name="Cooldown" type="Node" parent="StateChart/Mechanics/Cooldowns/Dash"]
script = ExtResource("5_dadqm")

[node name="On Cooldown" type="Node" parent="StateChart/Mechanics/Cooldowns/Dash/Cooldown"]
script = ExtResource("6_aaxtf")
to = NodePath("../../Useable")
delay_seconds = 1.0

[node name="Useable" type="Node" parent="StateChart/Mechanics/Cooldowns/Dash"]
script = ExtResource("5_dadqm")

[node name="On Dash" type="Node" parent="StateChart/Mechanics/Cooldowns/Dash/Useable"]
script = ExtResource("6_aaxtf")
to = NodePath("../../Cooldown")
event = &"dash"

[connection signal="death" from="HealthComponent" to="." method="_on_death"]
[connection signal="child_state_exited" from="StateChart/Mechanics/Movement" to="." method="reset_variables"]
[connection signal="child_state_exited" from="StateChart/Mechanics/Movement/Interruptible" to="." method="_on_movement_child_state_exited"]
[connection signal="child_state_exited" from="StateChart/Mechanics/Movement/Interruptible/Grounded" to="." method="_on_movement_child_state_exited"]
[connection signal="state_entered" from="StateChart/Mechanics/Movement/Interruptible/Grounded" to="." method="_on_grounded_state_entered"]
[connection signal="child_state_exited" from="StateChart/Mechanics/Movement/Interruptible/Grounded/Crouching" to="." method="_on_movement_child_state_exited"]
[connection signal="state_entered" from="StateChart/Mechanics/Movement/Interruptible/Grounded/Crouching" to="." method="_on_crouching_state_entered"]
[connection signal="state_entered" from="StateChart/Mechanics/Movement/Interruptible/Grounded/Crouching/Sliding" to="." method="_on_sliding_state_entered"]
[connection signal="child_state_exited" from="StateChart/Mechanics/Movement/Interruptible/Airborne" to="." method="_on_movement_child_state_exited"]
[connection signal="state_entered" from="StateChart/Mechanics/Movement/Interruptible/Airborne" to="." method="_on_airborne_state_entered"]
[connection signal="state_entered" from="StateChart/Mechanics/Movement/Interruptible/Airborne/Jumping" to="." method="_on_jumping_state_entered"]
[connection signal="state_entered" from="StateChart/Mechanics/Movement/Interruptible/WallSlide" to="." method="_on_wall_slide_state_entered"]
[connection signal="state_entered" from="StateChart/Mechanics/Movement/Dash" to="." method="_on_dash_state_entered"]
[connection signal="state_entered" from="StateChart/Mechanics/Movement/Disabled" to="." method="_on_locked_state_entered"]
